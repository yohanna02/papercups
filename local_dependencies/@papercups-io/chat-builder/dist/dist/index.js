function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=e(require("react")),n=e(require("@emotion/styled")),r=require("@papercups-io/browser");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){return t||(t=e.slice(0)),e.raw=t,e}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(){return t.createElement("div",{style:{display:"flex",margin:8,justifyContent:"center",alignItems:"center"}},t.createElement("a",{href:"https://papercups.io?utm_source=papercups&utm_medium=chat&utm_campaign=chat-builder-link",target:"_blank",rel:"noopener noreferrer",style:{color:"gray",opacity:.8,transition:"0.2s"}},"Powered by Papercups"))};function l(){}var u,d,p=function(e,t,n){if(e.addEventListener){for(var r,o=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}(t);!(r=o()).done;)e.addEventListener(r.value,n);return function(){return t.map(function(t){return e.removeEventListener(t,n)})}}return console.error("Custom events are not supported in your browser!"),l},f=function(){function e(e){this.debugModeEnabled=!!e}var t=e.prototype;return t.debug=function(){var e;this.debugModeEnabled&&(e=console).debug.apply(e,arguments)},t.log=function(){var e;this.debugModeEnabled&&(e=console).log.apply(e,arguments)},t.info=function(){var e;(e=console).info.apply(e,arguments)},t.warn=function(){var e;(e=console).warn.apply(e,arguments)},t.error=function(){var e;(e=console).error.apply(e,arguments)},e}(),g=function(e){return void 0!==e.hidden?{hidden:"hidden",event:"visibilitychange",state:"visibilityState"}:void 0!==e.mozHidden?{hidden:"mozHidden",event:"mozvisibilitychange",state:"mozVisibilityState"}:void 0!==e.msHidden?{hidden:"msHidden",event:"msvisibilitychange",state:"msVisibilityState"}:void 0!==e.webkitHidden?{hidden:"webkitHidden",event:"webkitvisibilitychange",state:"webkitVisibilityState"}:{hidden:null,event:null,state:null}},h=function(e){var t=g(e).hidden;return!!t&&!!e[t]},m=function(e,t){var n=g(e).event;return e.addEventListener(n,t,!1),function(){return e.removeEventListener(n,t)}};function v(e){var t=function(e){var t=Array.prototype,n=Function.prototype,r=Object.prototype,o=r.toString,i=r.hasOwnProperty,a=e.navigator,s=n.bind,c=t.forEach,l=Array.isArray,u=t.slice,d={},p=l||function(e){return"[object Array]"===o.call(e)};function f(e){try{return/^\s*\bfunction\b/.test(e)}catch(e){return!1}}function g(e){return"[object String]"==o.call(e)}function h(e){return void 0===e}function m(e,t,n){if(null!=e)if(c&&e.forEach===c)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,o=e.length;r<o;r++)if(r in e&&t.call(n,e[r],r,e)===d)return}else for(var a in e)if(i.call(e,a)&&t.call(n,e[a],a,e)===d)return}var v,y,b,S,w,x,C,E,O,M,k,I,P=(w={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},x=function(e){var t=new SyntaxError(e);throw t.at=v,t.text=b,t},C=function(e){return e&&e!==y&&x("Expected '"+e+"' instead of '"+y+"'"),y=b.charAt(v),v+=1,y},E=function(){var e,t="";for("-"===y&&(t="-",C("-"));y>="0"&&y<="9";)t+=y,C();if("."===y)for(t+=".";C()&&y>="0"&&y<="9";)t+=y;if("e"===y||"E"===y)for(t+=y,C(),"-"!==y&&"+"!==y||(t+=y,C());y>="0"&&y<="9";)t+=y,C();if(e=+t,isFinite(e))return e;x("Bad number")},O=function(){var e,t,n,r="";if('"'===y)for(;C();){if('"'===y)return C(),r;if("\\"===y)if(C(),"u"===y){for(n=0,t=0;t<4&&(e=parseInt(C(),16),isFinite(e));t+=1)n=16*n+e;r+=String.fromCharCode(n)}else{if("string"!=typeof w[y])break;r+=w[y]}else r+=y}x("Bad string")},M=function(){for(;y&&y<=" ";)C()},k=function(){var e=[];if("["===y){if(C("["),M(),"]"===y)return C("]"),e;for(;y;){if(e.push(S()),M(),"]"===y)return C("]"),e;C(","),M()}}x("Bad array")},I=function(){var e,t={};if("{"===y){if(C("{"),M(),"}"===y)return C("}"),t;for(;y;){if(e=O(),M(),C(":"),Object.hasOwnProperty.call(t,e)&&x('Duplicate key "'+e+'"'),t[e]=S(),M(),"}"===y)return C("}"),t;C(","),M()}}x("Bad object")},S=function(){switch(M(),y){case"{":return I();case"[":return k();case'"':return O();case"-":return E();default:return y>="0"&&y<="9"?E():function(){switch(y){case"t":return C("t"),C("r"),C("u"),C("e"),!0;case"f":return C("f"),C("a"),C("l"),C("s"),C("e"),!1;case"n":return C("n"),C("u"),C("l"),C("l"),null}x('Unexpected "'+y+'"')}()}},function(e){var t;return b=e,v=0,y=" ",t=S(),M(),y&&x("Syntax error"),t});function A(e){var t,n,r,o,i="";for(t=n=0,r=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,o=0;o<r;o++){var a=e.charCodeAt(o),s=null;a<128?n++:s=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==s&&(n>t&&(i+=e.substring(t,n)),i+=s,t=n=o+1)}return n>t&&(i+=e.substring(t,e.length)),i}return{ArrayProto:t,FuncProto:n,ObjProto:r,toString:o,hasOwnProperty:i,win:e,windowConsole:e.console,navigator:a,document:e.document,windowOpera:e.opera,screen:e.screen,userAgent:a.userAgent,intl:e.Intl,nativeBind:s,nativeForEach:c,nativeIndexOf:t.indexOf,nativeIsArray:l,slice:u,breaker:d,__NOOP:function(){},__NOOPTIONS:{},isFunction:f,isString:g,includes:function(e,t){return-1!==e.indexOf(t)},isUndefined:h,timestamp:function(){return Date.now=Date.now||function(){return+new Date},Date.now()},each:m,trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},extend:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return m(n,function(t){for(var n in t)void 0!==t[n]&&(e[n]=t[n])}),e},bind:function(e,t){var n,r;if(s&&e.bind===s)return s.apply(e,u.call(arguments,1));if(!f(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(t,n.concat(u.call(arguments)));var o={};o.prototype=e.prototype;var i=new o;o.prototype=null;var a=e.apply(i,n.concat(u.call(arguments)));return Object(a)===a?a:i}},truncate:function e(t,n){var r;return"string"==typeof t?r=t.slice(0,n):p(t)?(r=[],m(t,function(t){r.push(e(t,n))})):function(e){return e===Object(e)&&!p(e)}(t)?(r={},m(t,function(t,o){r[o]=e(t,n)})):r=t,r},stripEmptyProperties:function(e){var t={};return m(e,function(e,n){g(e)&&e.length>0&&(t[n]=e)}),t},HTTPBuildQuery:function(e,t){var n,r,o=[];return h(t)&&(t="&"),m(e,function(e,t){n=encodeURIComponent(e.toString()),r=encodeURIComponent(t),o[o.length]=r+"="+n}),o.join(t)},JSONEncode:function(e){var t=function(e){var t=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return t.lastIndex=0,t.test(e)?'"'+e.replace(t,function(e){var t=n[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'};return function e(n,r){var a="",s=0,c="",l="",u=0,d=a,p=[],f=r[n];switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(n)),typeof f){case"string":return t(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"undefined":return String(f);case"object":if(!f)return"null";if(a+="    ",p=[],"[object Array]"===o.apply(f)){for(u=f.length,s=0;s<u;s+=1)p[s]=e(s,f)||"null";return l=0===p.length?"[]":a?"[\n"+a+p.join(",\n"+a)+"\n"+d+"]":"["+p.join(",")+"]",a=d,l}for(c in f)i.call(f,c)&&(l=e(c,f))&&p.push(t(c)+(a?": ":":")+l);return l=0===p.length?"{}":a?"{"+p.join(",")+d+"}":"{"+p.join(",")+"}",a=d,l}}("",{"":e})},JSONDecode:P,utf8Encode:A,base64Encode:function(e){var t,n,r,o,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,s=0,c="",l=[];if(!e)return e;e=A(e);do{t=(o=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>12&63,n=o>>6&63,r=63&o,l[s++]=i.charAt(o>>18&63)+i.charAt(t)+i.charAt(n)+i.charAt(r)}while(a<e.length);switch(c=l.join(""),e.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c},getQueryParam:function(e,t){t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);if(null===n||n&&"string"!=typeof n[1]&&n[1].length)return"";var r=n[1];try{r=decodeURIComponent(r)}catch(e){console.error("Skipping decoding for malformed query param: "+r)}return r.replace(/\+/g," ")}}}(e),n=t.navigator,r=t.userAgent,o=t.windowOpera,i=t.intl,a=t.each,s=t.extend,c=t.includes,l=t.timestamp,u=t.stripEmptyProperties,d=t.getQueryParam,p={campaignParams:function(){var e="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),t="",n={};return a(e,function(e){(t=d(document.URL,e)).length&&(n[e]=t)}),n},searchEngine:function(e){return 0===e.search("https?://(.*)google.([^/?]*)")?"google":0===e.search("https?://(.*)bing.com")?"bing":0===e.search("https?://(.*)yahoo.com")?"yahoo":0===e.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(e){var t=p.searchEngine(e),n="yahoo"!=t?"q":"p",r={};if(null!==t){r.$search_engine=t;var o=d(e,n);o.length&&(r.ph_keyword=o)}return r},browser:function(e,t,n){return t=t||"",n||c(e," OPR/")?c(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":c(e,"IEMobile")||c(e,"WPDesktop")?"Internet Explorer Mobile":c(e,"SamsungBrowser/")?"Samsung Internet":c(e,"Edge")||c(e,"Edg/")?"Microsoft Edge":c(e,"FBIOS")?"Facebook Mobile":c(e,"Chrome")?"Chrome":c(e,"CriOS")?"Chrome iOS":c(e,"UCWEB")||c(e,"UCBrowser")?"UC Browser":c(e,"FxiOS")?"Firefox iOS":c(t,"Apple")?c(e,"Mobile")?"Mobile Safari":"Safari":c(e,"Android")?"Android Mobile":c(e,"Konqueror")?"Konqueror":c(e,"Firefox")?"Firefox":c(e,"MSIE")||c(e,"Trident/")?"Internet Explorer":c(e,"Gecko")?"Mozilla":""},browserVersion:function(e,t,n){var r={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge?\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Samsung Internet":/SamsungBrowser\/(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[p.browser(e,t,n)];if(void 0===r)return null;var o=e.match(r);return o?parseFloat(o[o.length-2]):null},os:function(){var e=r;return/Windows/i.test(e)?/Phone/.test(e)||/WPDesktop/.test(e)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"Mac OS X":/Linux/.test(e)?"Linux":/CrOS/.test(e)?"Chrome OS":""},device:function(e){return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":""},referringDomain:function(e){var t=e.split("/");return t.length>=3?t[2]:""},timezone:function(e){try{return e.DateTimeFormat().resolvedOptions().timeZone}catch(e){return null}},properties:function(){var t;return s(u({os:p.os(),browser:p.browser(r,n.vendor,o),referrer:document.referrer,referring_domain:p.referringDomain(document.referrer),device:p.device(r),time_zone:p.timezone(i)}),{current_url:e.location.href,host:e.location.host,pathname:e.location.pathname,browser_version:null===(t=p.browserVersion(r,n.vendor,o))||void 0===t?void 0:t.toString(),screen_height:screen.height,screen_width:screen.width,lib:"web",insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),time:l()/1e3})}};return p.properties()}var y=n.div(u||(u=a([""]))),b=n.div(d||(d=a(["\n  display: flex;\n"]))),S=n.div(function(e){var t=e.isOpen;return{margin:0,zIndex:2147483e3,position:"fixed",bottom:100,right:20,width:376,maxWidth:["90%","376px"],minHeight:t?250:0,maxHeight:["60%","704px"],background:"#fff",boxShadow:"rgba(0, 0, 0, 0.16) 0px 5px 40px",height:t?"calc(100% - 120px)":0,border:"none",borderRadius:8,overflow:"hidden",transition:"opacity 0.2s ease-in, transform 0.2s ease-in",opacity:t?1:0,transform:t?"none":"translateY(4px) translateZ(0px)",pointerEvents:t?"auto":"none"}}),w=n.div(function(e){var t=e.isOpen;return{margin:0,zIndex:2147483e3,position:"fixed",bottom:100,right:20,width:240,maxWidth:["90%","376px"],minHeight:t?250:0,maxHeight:["60%","704px"],background:"transparent",boxShadow:"none",height:t?"calc(100% - 120px)":0,border:"none",borderRadius:8,overflow:"hidden",transition:"opacity 0.2s ease-in, transform 0.2s ease-in",opacity:t?1:0,transform:t?"none":"translateY(4px) translateZ(0px)",pointerEvents:t?"auto":"none"}}),x=n.div({position:"fixed",zIndex:2147483003,bottom:20,right:20}),C=function(e){var n,a;function s(t){var n;return(n=e.call(this,t)||this).scrollToEl=null,n.subscriptions=[],n.EVENTS=["papercups:open","papercups:close","papercups:toggle","papercups:identify","storytime:customer:set"],n.onWidgetSettingsLoaded=function(e){var t,r,i=n.props.config,a=i.accountId,s=i.primaryColor,c=i.baseUrl,l=i.title,u=i.subtitle,d=i.greeting,p=i.newMessagePlaceholder,f=i.emailInputPlaceholder,g=i.newMessagesNotificationText,h=i.agentAvailableText,m=i.agentUnavailableText,y=i.showAgentAvailability,b=i.customer,S=void 0===b?{}:b,w=o({},v(window),S),x={accountId:a,baseUrl:c,agentAvailableText:h,agentUnavailableText:m,title:l||e.title,subtitle:u||e.subtitle,primaryColor:s||e.color,greeting:d||e.greeting,newMessagePlaceholder:p||e.new_message_placeholder,emailInputPlaceholder:f||e.email_input_placeholder,newMessagesNotificationText:g||e.new_messages_notification_text,companyName:null==e||null===(t=e.account)||void 0===t?void 0:t.company_name,showAgentAvailability:y||e.show_agent_availability,customerId:n.papercups.getCachedCustomerId(),subscriptionPlan:null==e||null===(r=e.account)||void 0===r?void 0:r.subscription_plan,metadata:w};n.setState({config:x}),n.papercups.updateWidgetSettingsMetadata(w)},n.customEventHandlers=function(e){if(!e||!e.type)return null;var t=e.detail;switch(e.type){case"papercups:open":return n.setOpenState(!0);case"papercups:close":return n.setOpenState(!1);case"papercups:toggle":return n.handleToggleOpen();case"storytime:customer:set":return console.warn("No handler has been set up to handle event `storytime:customer:set`",t);default:return null}},n.setOpenState=function(e){n.setState({isOpen:e},function(){n.handleVisibilityChange(),e&&n.scrollIntoView()})},n.handleToggleOpen=function(){var e=n.state;e.isLoaded&&n.setOpenState(!e.isOpen)},n.handleChatLoaded=function(){n.setState({isLoaded:!0});var e=n.props.onChatLoaded,t=void 0===e?l:e;t&&"function"==typeof t&&t(n.papercups)},n.handleNewMessageCallbacks=function(e){var t=n.props,o=t.onMessageReceived,i=void 0===o?l:o,a=t.onMessageSent,s=void 0===a?l:a;r.isAgentMessage(e)?i&&i(e):s&&s(e)},n.onSetCustomerId=function(e){if(n.logger.debug("Setting customer ID:",e),n.setState({customerId:e}),e){var t=o({},v(window),n.papercups.formatCustomerMetadata());n.papercups.updateExistingCustomer(e,t)}},n.onSetConversationId=function(e){n.setState({conversationId:e})},n.onConversationCreated=function(e,t){n.logger.debug("Conversation created:",{customerId:e,data:t})},n.onMessagesUpdated=function(e){n.setState({messages:e},function(){return n.scrollIntoView()});var t=e.filter(function(e){return!e.seen_at&&!!e.user_id});t.length>0&&n.handleUnseenMessages({message:t[0]})},n.onPresenceSync=function(e){n.logger.debug("Syncing presence:",e.list()),n.setState({availableAgents:e.list().map(function(e){return e.metas[0]}).filter(function(e){return!!e.user_id})})},n.scrollIntoView=function(){var e=n.props.scrollIntoViewOptions;n.scrollToEl&&n.scrollToEl.scrollIntoView(void 0!==e&&e)},n.handleUnseenMessages=function(e){n.logger.debug("Handling unseen messages:",e),n.setState({shouldDisplayNotifications:!0})},n.handleMessagesSeen=function(){n.logger.debug("Handling messages seen"),n.setState({shouldDisplayNotifications:!1})},n.handleVisibilityChange=function(e){var t=document||e&&e.target;if(!h(t)){var r=n.state.messages;(void 0===r?[]:r).some(function(e){return n.shouldMarkAsSeen(e)})&&n.markMessagesAsSeen()}},n.handlePapercupsPlan=function(e){void 0===e&&(e={}),n.logger.debug("Handling subscription plan:",e),n.setState({shouldDisplayBranding:!0})},n.handleToggleDisplay=function(e){void 0===e&&(e={});var t=!!e.isOpen;n.setState({isOpen:t},function(){n.handleVisibilityChange(),t&&n.scrollIntoView()})},n.handleNewMessage=function(e){n.handleNewMessageCallbacks(e),n.shouldMarkAsSeen(e)&&n.markMessagesAsSeen()},n.shouldMarkAsSeen=function(e){var t=n.state.isOpen;return!e.seen_at&&!h(document)&&r.isAgentMessage(e)&&t},n.markMessagesAsSeen=function(){n.papercups.markMessagesAsSeen(),n.handleMessagesSeen()},n.handleSendMessage=function(e,t){try{return n.papercups.sendNewMessage(e,t),Promise.resolve()}catch(e){return Promise.reject(e)}},n.state={config:{},messages:[],customerId:null,availableAgents:[],conversationId:null,isLoaded:!1,isSending:!1,isOpen:"function"==typeof t.children||!!t.isOpenByDefault,shouldDisplayNotifications:!1,shouldDisplayBranding:!0},n}a=e,(n=s).prototype=Object.create(a.prototype),n.prototype.constructor=n,i(n,a);var u=s.prototype;return u.componentDidMount=function(){try{var e=this,t=window,n=document||t.document,o=(i=t,Boolean("localhost"===i.location.hostname||"[::1]"===i.location.hostname||i.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))||!!e.props.debug);return e.papercups=r.Papercups.init({customerId:e.props.config.customerId,accountId:e.props.config.accountId,baseUrl:e.props.config.baseUrl,customer:e.props.config.customer,greeting:e.props.config.greeting,awayMessage:e.props.config.awayMessage,debug:e.props.debug,onPresenceSync:e.onPresenceSync,onSetCustomerId:e.onSetCustomerId,onSetConversationId:e.onSetConversationId,onSetWidgetSettings:e.onWidgetSettingsLoaded,onMessagesUpdated:e.onMessagesUpdated,onConversationCreated:e.onConversationCreated,onMessageCreated:e.handleNewMessage}),e.logger=new f(o),e.subscriptions=[p(window,e.EVENTS,e.customEventHandlers),m(n,e.handleVisibilityChange)],Promise.resolve(e.papercups.start()).then(function(){e.handleChatLoaded()})}catch(e){return Promise.reject(e)}var i},u.componentWillUnmount=function(){this.papercups.disconnect(),this.subscriptions.forEach(function(e){"function"==typeof e&&e()})},u.renderUnreadMessages=function(){var e=this.props.notifications;if(!e||"function"!=typeof e)return null;var n=this.state,r=n.customerId,i=n.messages,a=(void 0===i?[]:i).filter(function(e){var t=e.body;return!e.seen_at&&!function(e,t){return e.customer_id===t||!!e.sent_at&&"customer"===e.type}(e,r)&&t&&t.trim().length>0}).slice(0,2).map(function(e){var t,n,r=e.body;return o({},e,{body:(t=void 0===r?"":r,void 0===n&&(n=" "),t.length<=140?t:t.substr(0,t.lastIndexOf(n,140)).concat("..."))})});return 0===a.length?null:t.createElement(w,{isOpen:!0},t.createElement(b,{style:{background:"transparent",flexDirection:"column",justifyContent:"flex-end",height:"100%",width:"100%",flex:1}},e({config:this.props.config,state:this.state,unread:a,onToggleOpen:this.handleToggleOpen})))},u.render=function(){var e=this,n=this.props,r=n.config,i=n.styles,a=void 0===i?{}:i,s=n.children,l=this.state,u=l.isOpen,d=l.shouldDisplayNotifications,p=l.shouldDisplayBranding;return s?s({config:r,state:this.state,onClose:this.handleToggleOpen,onToggleOpen:this.handleToggleOpen,onSendMessage:this.handleSendMessage,scrollToRef:function(t){return e.scrollToEl=t}}):t.createElement(t.Fragment,null,!u&&d&&this.renderUnreadMessages(),t.createElement(S,{className:"Papercups-chatWindowContainer",isOpen:u},t.createElement(b,{style:{background:"#fff",flexDirection:"column",height:"100%",width:"100%",flex:1}},this.props.header&&this.props.header({config:r,state:this.state,onClose:this.handleToggleOpen}),t.createElement(y,{style:o({flex:1,overflowY:"scroll"},a.body)},this.props.body&&this.props.body({config:r,state:this.state,scrollToRef:function(t){return e.scrollToEl=t}})),p&&t.createElement(c,null),this.props.footer&&this.props.footer({config:r,state:this.state,onSendMessage:this.handleSendMessage}),t.createElement("img",{alt:"Papercups",src:"https://papercups.s3.us-east-2.amazonaws.com/papercups-logo.svg",width:"0",height:"0"}))),t.createElement(x,{className:"Papercups-toggleButtonContainer"},this.props.toggle&&this.props.toggle({config:r,state:this.state,onToggleOpen:this.handleToggleOpen})))},s}(t.Component),E=function(e){return t.createElement("div",{style:{display:"flex",paddingBottom:e.isNextSameSender?8:16,paddingLeft:48,paddingRight:0,justifyContent:"flex-end"}},t.createElement("div",{style:{fontSize:14,borderRadius:5,padding:"12px 16px",background:"rgb(24, 144, 255)",color:"#fff",whiteSpace:"pre-wrap"}},e.message.body))},O=function(e){var n,r=e.message,o=e.isNextSameSender,i=(null===(n=r.user)||void 0===n?void 0:n.profile_photo_url)||"https://avatars.slack-edge.com/2021-01-13/1619416452487_002cddd7d8aea1950018_192.png";return t.createElement("div",{style:{display:"flex",position:"relative",paddingBottom:o?8:16,paddingLeft:44,paddingRight:48,justifyContent:"flex-start",alignItems:"flex-end"}},!o&&t.createElement("div",{style:{height:32,width:32,position:"absolute",left:0,bottom:20,borderRadius:"50%",justifyContent:"center",alignItems:"center",backgroundPosition:"center",backgroundSize:"cover",backgroundImage:"url("+i+")"}}),t.createElement("div",{style:{fontSize:14,borderRadius:5,padding:"12px 16px",background:"rgb(245, 245, 245)",color:"rgba(0,0,0,.65)",whiteSpace:"pre-wrap"}},r.body))},M=n.button({outline:"none",border:"none",userSelect:"none",cursor:"pointer",width:"50px",height:"50px",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center","&:focus":{outline:"none"}}),k=function(){return t.createElement("svg",{width:"27",height:"27",viewBox:"0 0 27 27"},t.createElement("path",{fill:"transparent",strokeWidth:"3",stroke:"hsl(0, 0%, 99%)",strokeLinecap:"round",opacity:"0",d:"M 7.5 14.5 L 19 14.5"}),t.createElement("path",{fill:"transparent",strokeWidth:"3",stroke:"hsl(0, 0%, 99%)",strokeLinecap:"round",opacity:"0",d:"M 7.5 8.5 L 19 8.5"}),t.createElement("path",{fill:"transparent",strokeWidth:"3",stroke:"hsl(0, 0%, 99%)",strokeLinecap:"round",d:"M22 21.6453C22 20 23 19.5 23 19.5C23 19.5 25.5 18 25.5 14V9C25.5 4 23 1.5 18 1.5H9C4 1.5 1.5 4 1.5 9V14C1.5 19 4 21 9 21H13.5C14 21 14 21 15 21.5L20.25 24.8572L20.8517 25.2118C21.5184 25.6046 22 25.631 22 24.8572V24.0287V22.7858V21.6453Z",opacity:"1"}))},I=function(){return t.createElement("svg",{width:"24",height:"25",viewBox:"0 0 24 25",fill:"none"},t.createElement("path",{fill:"transparent",strokeWidth:"3",stroke:"hsl(0, 0%, 99%)",strokeLinecap:"round",opacity:"1",d:"M 5 5 L 20 20"}),t.createElement("path",{fill:"transparent",strokeWidth:"3",stroke:"hsl(0, 0%, 99%)",strokeLinecap:"round",opacity:"1",d:"M 5 20 L 20 5"}),t.createElement("path",{d:"M20.5 21.1453C20.5 19.5 21.5 19 21.5 19C21.5 19 24 18.5 24 13.5V8.5C24 3.5 21.5 1 16.5 1H7.5C2.5 1 0 3.5 0 8.5V13.5C0 18.5 2.5 20.5 7.5 20.5H12C12.5 20.5 12.5 20.5 13.5 21L18.75 24.3572L19.3517 24.7118C20.0184 25.1046 20.5 25.131 20.5 24.3572V23.5287V22.2858V21.1453Z",fill:"white",fillOpacity:"0.7",opacity:"0"}),t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.5 18C21.5 18 20.5 18.5 20.5 20.1453V21.2858V22.5287V23.3572C20.5 24.131 20.0184 24.1046 19.3517 23.7118L18.75 23.3572L13.5 20C12.8174 19.6587 12.6007 19.5504 12.3729 19.516C12.267 19.5 12.1587 19.5 12 19.5H7.5C2.5 19.5 0 17.5 0 12.5V7.5C0 2.5 2.5 0 7.5 0H16.5C21.5 0 24 2.5 24 7.5V12.5C24 17.5 21.5 18 21.5 18ZM21 17.557C21.8581 17.557 24 13.557 23 13.057C22.3869 12.7505 21.8801 13.7414 21.4646 14.554C21.2023 15.0668 20.9764 15.5086 20.783 15.5086C20.283 15.5086 20 16.0554 20 16.7568C20 17.4582 20.1419 17.557 21 17.557Z",fill:"white",opacity:"0"}))};exports.ChatBody=function(e){var n=e.state,r=e.scrollToRef,o=n.customerId,i=n.messages,a=void 0===i?[]:i;return t.createElement("div",{style:{padding:"16px 16px 0px"}},a.map(function(e,n){var r=e.customer_id===o||!!e.sent_at&&"customer"===e.type,i=a[n+1];return t.createElement(r?E:O,{key:e.id||n,message:e,isNextSameSender:r===(i&&(i.customer_id===o||!!i.sent_at&&"customer"===i.type))})}),t.createElement("div",{key:"scroll-el",ref:r}))},exports.ChatBuilder=C,exports.ChatFooter=function(e){var n=e.config,r=e.onSendMessage,o=t.useState(""),i=o[0],a=o[1],s=n.newMessagePlaceholder;return t.createElement("div",{style:{padding:8,borderTop:"1px solid rgb(230, 230, 230)",boxShadow:"rgba(0, 0, 0, 0.1) 0px 0px 100px 0px"}},t.createElement("form",{onSubmit:function(e){e.preventDefault(),r({body:i}),a("")}},t.createElement("input",{style:{border:"none",boxSizing:"border-box",width:"100%",padding:8,outline:0,fontSize:"1em"},value:i,placeholder:void 0===s?"Start typing...":s,onChange:function(e){return a(e.target.value)}})))},exports.ChatHeader=function(e){var n=e.config,r=n.title,o=n.subtitle,i=void 0===o?"How can we help you?":o;return t.createElement("div",{style:{padding:"16px",background:"rgb(24, 144, 255)",color:"#fff"}},t.createElement("h2",{style:{marginTop:4,marginBottom:4,fontWeight:500,color:"rgb(255, 255, 255)"}},void 0===r?"Welcome!":r),t.createElement("p",{style:{margin:0,color:"rgba(255, 255, 255, 0.8)"}},i))},exports.ChatToggle=function(e){return t.createElement(M,{style:{background:"rgb(24, 144, 255)"},onClick:e.onToggleOpen},t.createElement(e.isOpen?I:k,null))};
//# sourceMappingURL=index.js.map
